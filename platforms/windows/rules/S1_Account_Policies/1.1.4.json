{
    "rule_id": "1.1.4",
    "title": "Ensure 'Minimum password length' is set to '14 or more character(s)'",
    "description": "This policy setting determines the least number of characters that make up a password for a user account. In enterprise environments, the ideal value for the Minimum password length setting is 14 characters, however you should adjust this value to meet your organization's business requirements. The recommended state for this setting is: 14 or more character(s).",
    "cis_level": 1,
    "category": "Account Policies",
    "subcategory": "Password Policy",
    "applies_to": [
        "Windows 11",
        "Windows 10",
        "Windows Server 2022",
        "Windows Server 2019",
        "Windows Server 2016"
    ],
    "automated": true,
    "registry_config": null,
    "gpo_config": {
        "policy_path": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy",
        "setting_name": "Minimum password length",
        "setting_value": 14,
        "admx_category": "PasswordPolicy"
    },
    "implementation_local": {
        "powershell_command": "net accounts /minpwlen:14",
        "powershell_script": "$seceditExport = \"$env:TEMP\\secpol_export.cfg\"\n$seceditImport = \"$env:TEMP\\secpol_import.cfg\"\nsecedit /export /cfg $seceditExport /quiet\n$content = Get-Content $seceditExport\n$content = $content -replace 'MinimumPasswordLength\\s*=\\s*\\d+', 'MinimumPasswordLength = 14'\nif ($content -notmatch 'MinimumPasswordLength') {\n    $content = $content -replace '(\\[System Access\\])', \"`$1`nMinimumPasswordLength = 14\"\n}\n$content | Set-Content $seceditImport -Force\nsecedit /configure /db secedit.sdb /cfg $seceditImport /quiet\nRemove-Item $seceditExport, $seceditImport -Force -ErrorAction SilentlyContinue",
        "requires_admin": true,
        "requires_reboot": false
    },
    "implementation_gpo": {
        "inf_section": "[System Access]",
        "inf_key": "MinimumPasswordLength",
        "inf_value": "14"
    },
    "audit_logic": {
        "powershell_script": "try {\n    $output = net accounts 2>&1\n    $minLenLine = $output | Select-String 'Minimum password length'\n    if ($minLenLine) {\n        $value = [int](($minLenLine -replace '.*:\\s*', '').Trim() -replace '[^0-9]', '')\n        return ($value -ge 14)\n    }\n    return $false\n} catch {\n    return $false\n}",
        "expected_result": true
    },
    "remediation_rollback": {
        "powershell_command": "net accounts /minpwlen:0",
        "original_value": 0,
        "description": "Restores to Windows standalone default of 0 characters"
    },
    "impact": {
        "severity": "medium",
        "description": "Requirements for extremely long passwords can actually decrease the security of an organization, because users might leave the information in an insecure location or lose it. If very long passwords are required, mistyped passwords could cause account lockouts and increase the volume of help desk calls."
    },
    "rationale": "Types of password attacks include dictionary attacks (which attempt to use common words and phrases) and brute force attacks (which try every possible combination of characters). Also, attackers sometimes try to obtain the account database so they can use tools to discover the accounts and passwords.",
    "default_value": {
        "standalone": 0,
        "domain_joined": 7
    },
    "references": [
        "https://www.cisecurity.org/white-papers/cis-password-policy-guide/",
        "https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/password-policy"
    ],
    "tags": [
        "password",
        "account-policy",
        "authentication",
        "level-1",
        "automated",
        "password-length"
    ]
}