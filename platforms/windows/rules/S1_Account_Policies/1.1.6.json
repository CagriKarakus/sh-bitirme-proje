{
    "rule_id": "1.1.6",
    "title": "Ensure 'Relax minimum password length limits' is set to 'Enabled'",
    "description": "This policy setting determines whether the minimum password length setting can be increased beyond the legacy limit of 14 characters. The recommended state for this setting is: Enabled. Note: This setting only affects local accounts on the computer. Domain accounts are only affected by settings on the Domain Controllers.",
    "cis_level": 1,
    "category": "Account Policies",
    "subcategory": "Password Policy",
    "applies_to": [
        "Windows 11",
        "Windows 10 2004+",
        "Windows Server 2022",
        "Windows Server 2019"
    ],
    "automated": true,
    "registry_config": {
        "path": "HKLM:\\System\\CurrentControlSet\\Control\\SAM",
        "value_name": "RelaxMinimumPasswordLengthLimits",
        "value_type": "REG_DWORD",
        "value_data": 1,
        "comparison": "equals"
    },
    "gpo_config": {
        "policy_path": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Password Policy",
        "setting_name": "Relax minimum password length limits",
        "setting_value": 1,
        "admx_category": "PasswordPolicy"
    },
    "implementation_local": {
        "powershell_command": "Set-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\SAM' -Name 'RelaxMinimumPasswordLengthLimits' -Value 1 -Type DWord -Force",
        "powershell_script": "if (-not (Test-Path 'HKLM:\\System\\CurrentControlSet\\Control\\SAM')) {\n    New-Item -Path 'HKLM:\\System\\CurrentControlSet\\Control\\SAM' -Force | Out-Null\n}\nSet-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\SAM' -Name 'RelaxMinimumPasswordLengthLimits' -Value 1 -Type DWord -Force",
        "requires_admin": true,
        "requires_reboot": false
    },
    "implementation_gpo": {
        "inf_section": "[Registry Values]",
        "inf_key": "MACHINE\\System\\CurrentControlSet\\Control\\SAM\\RelaxMinimumPasswordLengthLimits",
        "inf_value": "4,1"
    },
    "audit_logic": {
        "powershell_script": "try {\n    $value = (Get-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\SAM' -Name 'RelaxMinimumPasswordLengthLimits' -ErrorAction SilentlyContinue).RelaxMinimumPasswordLengthLimits\n    return ($value -eq 1)\n} catch {\n    return $false\n}",
        "expected_result": true
    },
    "remediation_rollback": {
        "powershell_command": "Remove-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\SAM' -Name 'RelaxMinimumPasswordLengthLimits' -Force -ErrorAction SilentlyContinue",
        "original_value": null,
        "description": "Removes the registry value, restoring default behavior (14 char max limit)"
    },
    "impact": {
        "severity": "low",
        "description": "The Minimum password length setting may be configured higher than 14 characters. If very long passwords are required, mistyped passwords could cause account lockouts and increase the volume of help desk calls."
    },
    "rationale": "This setting will enable the enforcement of longer and generally stronger passwords or passphrases where MFA is not in use.",
    "default_value": {
        "standalone": 0,
        "domain_joined": 0
    },
    "references": [
        "https://www.cisecurity.org/white-papers/cis-password-policy-guide/",
        "https://support.microsoft.com/en-us/topic/minimum-password-length-auditing-and-enforcement-on-certain-versions-of-windows-5ef7fecf-3325-f56b-cc10-4fd565aacc59",
        "https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/password-policy"
    ],
    "tags": [
        "password",
        "account-policy",
        "authentication",
        "level-1",
        "automated",
        "password-length",
        "registry"
    ]
}