{
    "rule_id":  "2.2.29",
    "title":  "Ensure \u0027Log on as a service\u0027 is configured",
    "description":  "This policy setting determines which users or groups have the right described by this rule. The recommended state for this setting is: (configured - verify manually).",
    "cis_level":  2,
    "category":  "Local Policies",
    "subcategory":  "User Rights Assignment",
    "applies_to":  [
                       "Windows 11",
                       "Windows 10",
                       "Windows Server 2022",
                       "Windows Server 2019",
                       "Windows Server 2016"
                   ],
    "automated":  true,
    "registry_config":  null,
    "gpo_config":  {
                       "policy_path":  "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\User Rights Assignment",
                       "setting_name":  "Log on as a service",
                       "setting_value":  "(configured - verify manually)",
                       "admx_category":  "UserRightsAssignment"
                   },
    "implementation_local":  null,
    "implementation_gpo":  null,
    "audit_logic":  {
                        "powershell_script":  "try {\r\n    $tempFile = \"$env:TEMP\\secpol_audit_$([guid]::NewGuid().ToString(\u0027N\u0027)).cfg\"\r\n    secedit /export /cfg $tempFile /quiet 2\u003e\u00261 | Out-Null\r\n    if (Test-Path $tempFile) {\r\n        $content = Get-Content $tempFile -Raw\r\n        Remove-Item $tempFile -Force -ErrorAction SilentlyContinue\r\n        if ($content -match \u0027SeServiceLogonRight\\s*=\\s*(.*)\u0027) {\r\n            $val = $Matches[1].Trim()\r\n            return (-not [string]::IsNullOrWhiteSpace($val))\r\n        }\r\n        return $false\r\n    }\r\n    return $false\r\n} catch {\r\n    return $false\r\n}",
                        "expected_result":  true
                    },
    "remediation_rollback":  null,
    "impact":  {
                   "severity":  "medium",
                   "description":  "Changing this user right may affect compatibility with applications and services that require the privilege."
               },
    "rationale":  "Restricting user rights assignments reduces the attack surface and helps prevent unauthorized access or actions on the system.",
    "default_value":  {
                          "standalone":  "Varies",
                          "domain_joined":  "Varies"
                      },
    "references":  [
                       "https://www.cisecurity.org/benchmark/microsoft_windows_desktop/"
                   ],
    "tags":  [
                 "local-policy",
                 "user-rights",
                 "security",
                 "cis",
                 "level-2"
             ]
}