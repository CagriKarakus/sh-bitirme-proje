{
    "rule_id": "17.5.1",
    "title": "Ensure 'Audit Account Lockout' is set to include 'Failure'",
    "description": "This policy setting determines whether the OS generates audit events when specific actions occur.",
    "cis_level": 1,
    "category": "Advanced Audit Policy",
    "applies_to": [
        "Windows 11",
        "Windows 10",
        "Windows Server 2022",
        "Windows Server 2019",
        "Windows Server 2016"
    ],
    "automated": true,
    "registry_config": {},
    "gpo_config": {
        "policy_path": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies",
        "setting_name": "Audit Account Lockout",
        "setting_value": "Failure",
        "admx_category": "AuditPolicies"
    },
    "implementation_local": {
        "powershell_command": "auditpol /set /subcategory:\"Account Lockout\" /success:disable /failure:enable",
        "powershell_script": "",
        "requires_admin": true,
        "requires_reboot": false
    },
    "implementation_gpo": {
        "gpo_xml": ""
    },
    "audit_logic": {
        "powershell_script": "$out = auditpol /get /subcategory:\"Account Lockout\" /r | Select-String \"Account Lockout\"; return ($out -match \"Failure\")",
        "expected_result": true
    },
    "remediation_rollback": {
        "powershell_command": "auditpol /set /subcategory:\"Account Lockout\" /success:disable /failure:disable"
    },
    "impact": {
        "severity": "medium",
        "description": "Enabling audit policies can generate a significant amount of events, potentially impacting system performance and storage."
    },
    "rationale": "Auditing critical events allows security personnel to track and respond to potential threats or policy violations effectively.",
    "default_value": {
        "standalone": "No Auditing",
        "domain_joined": "No Auditing"
    },
    "references": [
        "https://www.cisecurity.org/benchmark/microsoft_windows_desktop/"
    ],
    "tags": [
        "audit-policy",
        "cis",
        "security",
        "level-1"
    ]
}